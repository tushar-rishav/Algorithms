$(document).ready(function(){var t=$(".notification-listbox");$(".notification-box-todo>#todo-notification-icon, .notification-box-todo>.notification-counter").click(function(o){if(t.is(":hidden")){t.show();show_todo_notification(t)}else{hide_todo_notification(t)}o.preventDefault()});$(document).keyup(function(o){if(o.keyCode==27){hide_todo_notification(t)}});updateNotifCounter();setTimeout("updateNotifCounter",5e3)});function show_todo_notification(t){if($(".notification-listbox-head").length>0){$(".notification-listbox-head").after('<div class="notification-listbox-loader"></div>')}setTimeout(function(){$.ajax({url:"/todo/notification",type:"GET",dataType:"json",success:function(o){var i=o.count;t.empty().html(o.html);if(i>0){$(".notification-counter").text(i)}},error:function(o,i,n){t.empty().append("Sorry your Todo list can not be rendered.")}})},1e3)}function hide_todo_notification(t){t.hide()}function widget_add_todo(t,o,i){var n=t.target;$.ajax({type:"POST",url:"/api/todo/add",dataType:"json",data:{pcode:o,ccode:i}}).done(function(t){if(typeof $.growl==="function"){$.growl({title:"Success",message:t.message})}else{$($(n).next(".todo-button-message")[0]).html(t.message)}$(n).prop("src","/sites/all/themes/abessive/images/add2.png");$(n).prop("title","Problem already present in Todo list");incrementNotifCouter()}).fail(function(t){var o=JSON.parse(t.responseText);if(typeof $.growl==="function"){$.growl({title:"Error",message:o.message})}else{$($(n).next(".todo-button-message")[0]).html(o.message)}})}function updateNotifCounter(){$.ajax({url:"/todo/notification/count",type:"GET",dataType:"json",success:function(t){var o=t.todoCount;$(".notification-counter").text(o)}})}function incrementNotifCouter(){var t=$(".notification-counter").html();if(t===""){$(".notification-counter").html(1)}else{$(".notification-counter").html(parseInt(t)+1)}}function decrementNotifCouter(){var t=$(".notification-counter").html();$(".notification-counter").html(parseInt(t)-1)}function setNotifCounter(t){$(".notification-counter").html(parseInt(t))}